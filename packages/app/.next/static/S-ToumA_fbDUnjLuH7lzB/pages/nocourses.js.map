{"version":3,"sources":["webpack:////var/www/source/node_modules/next/dist/build/webpack/loaders/next-client-pages-loader.js?f106","webpack:///./hooks/useHomePageRedirect.ts","webpack:///./hooks/useLocalStorage.ts","webpack:///./pages/nocourses.tsx"],"names":["window","__NEXT_P","push","useHomePageRedirect","profile","useProfile","useLocalStorage","defaultCourse","pendingCourses","length","Router","courses","isUserInDefaultCourse","some","c","course","id","isWindow","key","initialValue","useState","item","localStorage","getItem","JSON","parse","error","console","storedValue","setStoredValue","value","valueToStore","Function","setItem","stringify","removeItem","NoCourses","data","useSWR","a","API","selfEnrollCourses","status","title","subTitle","style","textAlign","map","i","onClick","createSelfEnrollOverride","name"],"mappings":"kFACKA,OAAOC,SAAWD,OAAOC,UAAY,IAAIC,KAAK,CAC7C,aACA,WACE,OAAO,EAAQ,Y,iICKhB,SAASC,IACd,IAAMC,EAAgBC,cADuB,EAErBC,YAAgB,gBAAiB,MAAlDC,EAFsC,oBAG7C,GAAIH,GAAWA,EAAQI,gBAAkBJ,EAAQI,eAAeC,OAAS,EAEvE,OADAC,IAAOR,KAAK,WACL,EAET,GAAIE,GAAWA,EAAQO,QAAQF,OAAS,EAAG,CAEzC,IAAMG,IACFL,GACFH,EAAQO,QAAQE,MAAK,SAACC,GAAD,OAAOA,EAAEC,OAAOC,MAAT,OAAgBT,QAAhB,IAAgBA,OAAhB,EAAgBA,EAAeS,OAO7D,OANAN,IAAOR,KACL,sBADF,kBAGIU,EAAwBL,EAAcS,GAAKZ,EAAQO,QAAQ,GAAGI,OAAOC,GAHzE,YAMO,EAET,OAAO,I,kCC7BT,kDAEMC,GAAW,EAEV,SAASX,EACdY,EACAC,GACkE,MAC5BC,oBAAY,WAChD,IACE,IAAMC,EAAOJ,GAAYjB,OAAOsB,aAAaC,QAAQL,GACrD,OAAOG,EAAOG,KAAKC,MAAMJ,GAAQF,EACjC,MAAOO,GAEP,OADAC,QAAQD,MAAMA,GACPP,MANJS,EAD2D,KAC9CC,EAD8C,KAkClE,MAAO,CAACD,EAvBS,SAACE,GAChB,IACE,IAAMC,EACJD,aAAiBE,SAAWF,EAAMF,GAAeE,EACnDD,EAAeE,GAEfd,GACEjB,OAAOsB,aAAaW,QAAQf,EAAKM,KAAKU,UAAUH,IAClD,MAAOL,GACPC,QAAQD,MAAMA,KAIE,WAClB,IACEG,EAAe,MAEfZ,GAAYjB,OAAOsB,aAAaa,WAAWjB,GAC3C,MAAOQ,GACPC,QAAQD,MAAMA,Q,gPC9BL,SAASU,IACtBjC,cADgD,IAGxCkC,EAASC,YAAO,sCAAD,sBAAwC,sBAAAC,EAAA,+EAC7DC,IAAIzB,OAAO0B,qBADkD,4CAAvDJ,KAIR,OACE,aACE,EAAC,IAAD,CACEK,OAAO,OACPC,MAAM,8DACNC,SAAS,0JAEN,OAAJP,QAAI,IAAJA,OAAA,EAAAA,EAAM1B,QAAQF,QAAS,EACtB,SAAKoC,MAAO,CAAEC,UAAW,WAAzB,0KAIE,oBACGT,QADH,IACGA,OADH,EACGA,EAAM1B,QAAQoC,KAAI,SAAChC,EAAQiC,GAC1B,OACE,EAAC,IAAD,CACE9B,IAAK8B,EACLC,QAAO,sBAAE,sBAAAV,EAAA,sEACDC,IAAIzB,OAAOmC,yBAAyBnC,EAAOC,IAD1C,OAEPN,IAAOR,KAAK,UAFL,4CAKRa,EAAOoC,WAMhB,S","file":"static/S-ToumA_fbDUnjLuH7lzB/pages/nocourses.js","sourcesContent":["\n    (window.__NEXT_P = window.__NEXT_P || []).push([\n      \"/nocourses\",\n      function () {\n        return require(\"private-next-pages/nocourses.tsx\");\n      }\n    ]);\n  ","import { User } from \"@koh/common\";\nimport Router from \"next/router\";\nimport { useLocalStorage } from \"./useLocalStorage\";\nimport { useProfile } from \"./useProfile\";\n\n/**\n * Redirect user to the course apply page if they are a prof with pending courses,\n * or to the today page for their default course.\n */\nexport function useHomePageRedirect(): boolean {\n  const profile: User = useProfile();\n  const [defaultCourse] = useLocalStorage(\"defaultCourse\", null);\n  if (profile && profile.pendingCourses && profile.pendingCourses.length > 0) {\n    Router.push(\"/apply\");\n    return true;\n  }\n  if (profile && profile.courses.length > 0) {\n    /// defaultCourse can get out-of-sync with the user's actual registered course (dropped class etc)\n    const isUserInDefaultCourse =\n      !!defaultCourse &&\n      profile.courses.some((c) => c.course.id === defaultCourse?.id);\n    Router.push(\n      \"/course/[cid]/today\",\n      `/course/${\n        isUserInDefaultCourse ? defaultCourse.id : profile.courses[0].course.id\n      }/today`\n    );\n    return true;\n  }\n  return false;\n}\n","import { useState, Dispatch, SetStateAction } from \"react\";\n\nconst isWindow = typeof window !== \"undefined\";\n\nexport function useLocalStorage<T>(\n  key: string,\n  initialValue: T\n): [T, Dispatch<SetStateAction<T>>, Dispatch<SetStateAction<void>>] {\n  const [storedValue, setStoredValue] = useState<T>(() => {\n    try {\n      const item = isWindow && window.localStorage.getItem(key);\n      return item ? JSON.parse(item) : initialValue;\n    } catch (error) {\n      console.error(error);\n      return initialValue;\n    }\n  });\n\n  const setValue = (value: T) => {\n    try {\n      const valueToStore =\n        value instanceof Function ? value(storedValue) : value;\n      setStoredValue(valueToStore);\n\n      isWindow &&\n        window.localStorage.setItem(key, JSON.stringify(valueToStore));\n    } catch (error) {\n      console.error(error);\n    }\n  };\n\n  const removeValue = () => {\n    try {\n      setStoredValue(null);\n\n      isWindow && window.localStorage.removeItem(key);\n    } catch (error) {\n      console.error(error);\n    }\n  };\n\n  return [storedValue, setValue, removeValue];\n}\n","import { API } from \"@koh/api-client\";\nimport { Button, Result } from \"antd\";\nimport Router from \"next/router\";\nimport { ReactElement } from \"react\";\nimport useSWR from \"swr\";\nimport { useHomePageRedirect } from \"../hooks/useHomePageRedirect\";\n\nexport default function NoCourses(): ReactElement {\n  useHomePageRedirect();\n\n  const { data } = useSWR(\"/api/v1/courses/self_enroll_courses\", async () =>\n    API.course.selfEnrollCourses()\n  );\n\n  return (\n    <div>\n      <Result\n        status=\"info\"\n        title=\"None of your courses are using the Khoury Office Hours App.\"\n        subTitle=\"If you expected your course to be here, try logging in again. If it still does not appear, please reach out to your course coordinator or professor.\"\n      />\n      {data?.courses.length > 0 ? (\n        <div style={{ textAlign: \"center\" }}>\n          One of our data sources for student-enrollment is currently\n          experiencing an outage. If you think you belong to a class, please\n          click on your corresponding class below.\n          <div>\n            {data?.courses.map((course, i) => {\n              return (\n                <Button\n                  key={i}\n                  onClick={async () => {\n                    await API.course.createSelfEnrollOverride(course.id);\n                    Router.push(\"/login\");\n                  }}\n                >\n                  {course.name}\n                </Button>\n              );\n            })}\n          </div>\n        </div>\n      ) : null}\n    </div>\n  );\n}\n"],"sourceRoot":""}