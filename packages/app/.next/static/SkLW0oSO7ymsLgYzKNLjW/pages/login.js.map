{"version":3,"sources":["webpack:///./hooks/useDefaultCourseRedirect.ts","webpack:///./pages/login.tsx","webpack:///./hooks/useProfile.ts","webpack:///./hooks/useLocalStorage.ts","webpack:////home/runner/work/office-hours/office-hours/node_modules/next/dist/build/webpack/loaders/next-client-pages-loader.js?6a63"],"names":["useDefaultCourseRedirect","profile","useProfile","useLocalStorage","defaultCourse","courses","length","isUserInDefaultCourse","some","c","course","id","Router","push","Container","styled","div","ContentContainer","Login","didRedirect","href","pathname","useRouter","useSWR","a","API","index","data","error","response","status","isWindow","key","initialValue","useState","item","window","localStorage","getItem","JSON","parse","console","storedValue","setStoredValue","value","valueToStore","Function","setItem","stringify","removeItem","__NEXT_P"],"mappings":"6LAKO,SAASA,IACd,IAAMC,EAAgBC,cAD4B,EAE1BC,YAAgB,gBAAiB,MAAlDC,EAF2C,oBAGlD,GAAIH,GAAWA,EAAQI,QAAQC,OAAS,EAAG,CAEzC,IAAMC,IACFH,GACFH,EAAQI,QAAQG,MAAK,SAACC,GAAD,OAAOA,EAAEC,OAAOC,MAAT,OAAgBP,QAAhB,IAAgBA,OAAhB,EAAgBA,EAAeO,OAO7D,OANAC,IAAOC,KACL,sBADF,kBAGIN,EAAwBH,EAAcO,GAAKV,EAAQI,QAAQ,GAAGK,OAAOC,GAHzE,YAMO,EAET,OAAO,I,qMCbHG,EAAYC,IAAOC,IAAV,mEAAGD,CAAH,yEAOTE,EAAmBF,IAAOC,IAAV,0EAAGD,CAAH,wBAIP,SAASG,IACtB,IAAMjB,EAAgBC,cAChBiB,EAAcnB,cAKpB,OAJIC,IAAYkB,GACdP,IAAOC,KAAK,cAIZ,EAACC,EAAD,KACE,EAACG,EAAD,KACE,+CACA,+DACA,EAAC,IAAD,CAAQG,KAAK,oEAAb,+B,wMCxBKlB,EAAmB,WAAM,MAC5BmB,EAAaC,sBAAbD,SAD4B,EAEZE,YAAO,iBAAD,sBAE5B,sBAAAC,EAAA,sEAAkBC,IAAIxB,QAAQyB,QAA9B,oFAFMC,EAF4B,EAE5BA,KAAMC,EAFsB,EAEtBA,MAMd,GAAgC,OAAvB,OAALA,QAAK,IAALA,OAAA,YAAAA,EAAOC,gBAAP,eAAiBC,SAA+B,WAAbT,EACrCT,IAAOC,KAAK,eACP,GAAIc,EACT,OAAOA,I,kCClBX,kDAEMI,GAAW,EAEV,SAAS5B,EACd6B,EACAC,GACkE,MAC5BC,oBAAY,WAChD,IACE,IAAMC,EAAOJ,GAAYK,OAAOC,aAAaC,QAAQN,GACrD,OAAOG,EAAOI,KAAKC,MAAML,GAAQF,EACjC,MAAOL,GAEP,OADAa,QAAQb,MAAMA,GACPK,MANJS,EAD2D,KAC9CC,EAD8C,KAkClE,MAAO,CAACD,EAvBS,SAACE,GAChB,IACE,IAAMC,EACJD,aAAiBE,SAAWF,EAAMF,GAAeE,EACnDD,EAAeE,GAEfd,GACEK,OAAOC,aAAaU,QAAQf,EAAKO,KAAKS,UAAUH,IAClD,MAAOjB,GACPa,QAAQb,MAAMA,KAIE,WAClB,IACEe,EAAe,MAEfZ,GAAYK,OAAOC,aAAaY,WAAWjB,GAC3C,MAAOJ,GACPa,QAAQb,MAAMA,Q,sBCpCfQ,OAAOc,SAAWd,OAAOc,UAAY,IAAIrC,KAAK,CAC7C,SACA,WACE,OAAO,EAAQ,a","file":"static/SkLW0oSO7ymsLgYzKNLjW/pages/login.js","sourcesContent":["import { User } from \"@koh/common\";\nimport Router from \"next/router\";\nimport { useLocalStorage } from \"./useLocalStorage\";\nimport { useProfile } from \"./useProfile\";\n\nexport function useDefaultCourseRedirect(): boolean {\n  const profile: User = useProfile();\n  const [defaultCourse] = useLocalStorage(\"defaultCourse\", null);\n  if (profile && profile.courses.length > 0) {\n    /// defaultCourse can get out-of-sync with the user's actual registered course (dropped class etc)\n    const isUserInDefaultCourse =\n      !!defaultCourse &&\n      profile.courses.some((c) => c.course.id === defaultCourse?.id);\n    Router.push(\n      \"/course/[cid]/today\",\n      `/course/${\n        isUserInDefaultCourse ? defaultCourse.id : profile.courses[0].course.id\n      }/today`\n    );\n    return true;\n  }\n  return false;\n}\n","import { Button } from \"antd\";\nimport styled from \"styled-components\";\nimport { ReactElement } from \"react\";\nimport { useDefaultCourseRedirect } from \"../hooks/useDefaultCourseRedirect\";\nimport { User } from \"@koh/common\";\nimport Router from \"next/router\";\nimport { useProfile } from \"../hooks/useProfile\";\n\nconst Container = styled.div`\n  height: 80vh;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n`;\n\nconst ContentContainer = styled.div`\n  text-align: center;\n`;\n\nexport default function Login(): ReactElement {\n  const profile: User = useProfile();\n  const didRedirect = useDefaultCourseRedirect();\n  if (profile && !didRedirect) {\n    Router.push(\"/nocourses\");\n  }\n\n  return (\n    <Container>\n      <ContentContainer>\n        <h1>You are currently not logged in</h1>\n        <p>Click the button below to login via Khoury Admin</p>\n        <Button href=\"https://admin.khoury.northeastern.edu/teaching/officehourslogin/\">\n          Log in via Khoury Admin\n        </Button>\n      </ContentContainer>\n    </Container>\n  );\n}\n","import useSWR from \"swr\";\nimport { API } from \"@koh/api-client\";\nimport Router, { useRouter } from \"next/router\";\nimport { User } from \"@koh/common\";\n\ntype Hook = () => User;\n\nexport const useProfile: Hook = () => {\n  const { pathname } = useRouter();\n  const { data, error } = useSWR(\n    `api/v1/profile`,\n    async () => await API.profile.index()\n  );\n\n  // Redirect to login page (later Khoury Admin login) if API request returns an error or empty object\n  if (error?.response?.status === 401 && pathname !== \"/login\") {\n    Router.push(\"/login\");\n  } else if (data) {\n    return data;\n  }\n};\n","import { useState, Dispatch, SetStateAction } from \"react\";\n\nconst isWindow = typeof window !== \"undefined\";\n\nexport function useLocalStorage<T>(\n  key: string,\n  initialValue: T\n): [T, Dispatch<SetStateAction<T>>, Dispatch<SetStateAction<void>>] {\n  const [storedValue, setStoredValue] = useState<T>(() => {\n    try {\n      const item = isWindow && window.localStorage.getItem(key);\n      return item ? JSON.parse(item) : initialValue;\n    } catch (error) {\n      console.error(error);\n      return initialValue;\n    }\n  });\n\n  const setValue = (value: T) => {\n    try {\n      const valueToStore =\n        value instanceof Function ? value(storedValue) : value;\n      setStoredValue(valueToStore);\n\n      isWindow &&\n        window.localStorage.setItem(key, JSON.stringify(valueToStore));\n    } catch (error) {\n      console.error(error);\n    }\n  };\n\n  const removeValue = () => {\n    try {\n      setStoredValue(null);\n\n      isWindow && window.localStorage.removeItem(key);\n    } catch (error) {\n      console.error(error);\n    }\n  };\n\n  return [storedValue, setValue, removeValue];\n}\n","\n    (window.__NEXT_P = window.__NEXT_P || []).push([\n      \"/login\",\n      function () {\n        return require(\"private-next-pages/login.tsx\");\n      }\n    ]);\n  "],"sourceRoot":""}