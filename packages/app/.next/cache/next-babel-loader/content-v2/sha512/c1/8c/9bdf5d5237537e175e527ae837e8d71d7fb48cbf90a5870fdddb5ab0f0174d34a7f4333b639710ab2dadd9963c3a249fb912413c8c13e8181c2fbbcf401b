{"ast":null,"code":"import { jsx as _jsx } from \"react/jsx-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-runtime\";\nimport _regeneratorRuntime from \"/var/www/source/node_modules/next/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/var/www/source/node_modules/next/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"/var/www/source/node_modules/next/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport { API } from \"@koh/api-client\";\nimport { Modal, notification } from \"antd\";\nimport { useState } from \"react\";\nimport { NotionRenderer } from \"react-notion\";\nimport useSWR from \"swr\";\nimport { useLocalStorage } from \"../../hooks/useLocalStorage\";\nexport default function ReleaseNotes() {\n  var _useLocalStorage = useLocalStorage(\"releaseNotesLastSeen\", null),\n      _useLocalStorage2 = _slicedToArray(_useLocalStorage, 2),\n      releaseNotesLastSeen = _useLocalStorage2[0],\n      setReleaseNotesLastSeen = _useLocalStorage2[1];\n\n  var _useState = useState(false),\n      showReleaseNotes = _useState[0],\n      setShowReleaseNotes = _useState[1];\n\n  var _useSWR = useSWR(\"api/v1/release_notes\", /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            return _context.abrupt(\"return\", API.releaseNotes.get());\n\n          case 1:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee);\n  }))),\n      data = _useSWR.data;\n\n  if (!releaseNotesLastSeen && data !== null && data !== void 0 && data.lastUpdatedUnixTime || new Date(releaseNotesLastSeen) < new Date(data === null || data === void 0 ? void 0 : data.lastUpdatedUnixTime)) {\n    notification.open({\n      message: \"We've got new features/bug fixes\",\n      type: \"info\",\n      duration: 0,\n      description: \"Click to see what's new!\",\n      className: \"clickable-notification hide-in-percy\",\n      style: {\n        cursor: \"pointer\"\n      },\n      onClick: function onClick() {\n        setShowReleaseNotes(true);\n        notification.destroy();\n      }\n    });\n    setReleaseNotesLastSeen(new Date());\n  }\n\n  var openLinksInNewTab = function openLinksInNewTab(e) {\n    if (e.target.className === \"notion-link\") {\n      e.preventDefault();\n      window.open(e.target.href);\n    }\n  };\n\n  return /*#__PURE__*/_jsx(\"div\", {\n    onClick: openLinksInNewTab,\n    children: data !== null && data !== void 0 && data.releaseNotes ? /*#__PURE__*/_jsx(Modal, {\n      title: \"Release Notes\",\n      visible: showReleaseNotes,\n      bodyStyle: {\n        padding: \"0px 24px\"\n      },\n      footer: /*#__PURE__*/_jsx(_Fragment, {}),\n      width: 625,\n      onCancel: function onCancel() {\n        return setShowReleaseNotes(false);\n      },\n      children: /*#__PURE__*/_jsx(NotionRenderer, {\n        blockMap: data.releaseNotes\n      })\n    }) : null\n  });\n}","map":null,"metadata":{},"sourceType":"module"}