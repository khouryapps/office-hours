{"ast":null,"code":"import { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport { CloudSyncOutlined, ExclamationCircleOutlined, FrownOutlined, NotificationOutlined, StopOutlined } from \"@ant-design/icons\";\nimport { Button, message, Modal, Popconfirm, Tag, Tooltip } from \"antd\";\nimport Linkify from \"react-linkify\";\nimport moment from \"moment\";\nimport React, { useState } from \"react\";\nimport styled from \"styled-components\";\nimport { useQueue } from \"../../hooks/useQueue\";\nimport { RenderEvery } from \"../RenderEvery\";\nimport { TAStatuses } from \"./TAStatuses\";\nimport { API } from \"@koh/api-client\";\nimport Router from \"next/router\";\nexport const Container = styled.div.withConfig({\n  displayName: \"QueueListSharedComponents__Container\",\n  componentId: \"sc-1abq9vy-0\"\n})([\"display:flex;flex-direction:row;align-items:center;\"]);\nconst QueueTitle = styled.div.withConfig({\n  displayName: \"QueueListSharedComponents__QueueTitle\",\n  componentId: \"sc-1abq9vy-1\"\n})([\"font-weight:500;font-size:24px;color:#212934;\"]);\nexport const NotesText = styled.div.withConfig({\n  displayName: \"QueueListSharedComponents__NotesText\",\n  componentId: \"sc-1abq9vy-2\"\n})([\"font-size:16px;color:#5f6b79;\"]); // New queue styled components start here\n\nconst InfoColumnContainer = styled.div.withConfig({\n  displayName: \"QueueListSharedComponents__InfoColumnContainer\",\n  componentId: \"sc-1abq9vy-3\"\n})([\"flex-shrink:0;padding-bottom:30px;position:relative;display:flex;flex-direction:column;@media (min-width:650px){margin-top:32px;width:290px;}\"]);\nconst QueueInfoColumnButtonStyle = styled(Button).withConfig({\n  displayName: \"QueueListSharedComponents__QueueInfoColumnButtonStyle\",\n  componentId: \"sc-1abq9vy-4\"\n})([\"font-weight:500;font-size:14px;border:1px solid #cfd6de;border-radius:6px;margin-bottom:12px;\"]);\nconst {\n  confirm\n} = Modal;\nexport const QueueInfoColumnButton = props => /*#__PURE__*/_jsx(QueueInfoColumnButtonStyle, _objectSpread({\n  size: \"large\",\n  block: true\n}, props));\nconst QueuePropertyRow = styled.div.withConfig({\n  displayName: \"QueueListSharedComponents__QueuePropertyRow\",\n  componentId: \"sc-1abq9vy-5\"\n})([\"display:flex;flex-direction:row;align-items:center;margin-bottom:20px;color:#5f6b79;font-size:20px;\"]);\nconst QueuePropertyText = styled.div.withConfig({\n  displayName: \"QueueListSharedComponents__QueuePropertyText\",\n  componentId: \"sc-1abq9vy-6\"\n})([\"margin-left:12px;font-size:16px;min-width:0;overflow-wrap:break-word;white-space:pre-wrap;\"]);\nconst StaffH2 = styled.h2.withConfig({\n  displayName: \"QueueListSharedComponents__StaffH2\",\n  componentId: \"sc-1abq9vy-7\"\n})([\"margin-top:32px;\"]);\nconst QueueRoomGroup = styled.div.withConfig({\n  displayName: \"QueueListSharedComponents__QueueRoomGroup\",\n  componentId: \"sc-1abq9vy-8\"\n})([\"display:flex;flex-direction:row;align-items:center;\"]);\nconst QueueInfo = styled.div.withConfig({\n  displayName: \"QueueListSharedComponents__QueueInfo\",\n  componentId: \"sc-1abq9vy-9\"\n})([\"margin-bottom:24px;\"]);\nconst QueueText = styled.div.withConfig({\n  displayName: \"QueueListSharedComponents__QueueText\",\n  componentId: \"sc-1abq9vy-10\"\n})([\"max-height:200px;overflow-y:auto;width:100%;\"]);\nconst DisableQueueButton = styled(QueueInfoColumnButton).withConfig({\n  displayName: \"QueueListSharedComponents__DisableQueueButton\",\n  componentId: \"sc-1abq9vy-11\"\n})([\"color:white;background:#da3236;&:hover,&:focus{color:#da3236;background:#fff;border-color:#da3236;}\"]);\nconst ClearQueueButton = styled(QueueInfoColumnButton).withConfig({\n  displayName: \"QueueListSharedComponents__ClearQueueButton\",\n  componentId: \"sc-1abq9vy-12\"\n})([\"color:#d4380d;background:#fff;border-color:#d4380d;&:hover,&:focus{background:#fff;color:#da3236;border-color:#da3236;}\"]);\nconst QueueManagementBox = styled.div.withConfig({\n  displayName: \"QueueListSharedComponents__QueueManagementBox\",\n  componentId: \"sc-1abq9vy-13\"\n})([\"display:flex;flex-direction:column;justify-content:flex-end;color:white;width:100%;height:100%;bottom:0;\"]);\nexport function QueueInfoColumn({\n  queueId,\n  isStaff,\n  buttons\n}) {\n  const {\n    queue,\n    mutateQueue\n  } = useQueue(queueId);\n\n  const disableQueue = async () => {\n    await API.queues.disable(queueId);\n    await mutateQueue();\n    message.success(\"Successfully disabled queue: \" + queue.room);\n    await Router.push(\"/\");\n  };\n\n  const clearQueue = async () => {\n    await API.queues.clean(queueId);\n    await mutateQueue();\n    message.success(\"Successfully cleaned queue: \" + queue.room);\n  };\n\n  const confirmDisable = () => {\n    confirm({\n      title: `Please Confirm!`,\n      icon: /*#__PURE__*/_jsx(ExclamationCircleOutlined, {}),\n      style: {\n        whiteSpace: \"pre-wrap\"\n      },\n      content: `Please confirm that you want to disable the queue: ${queue.room}.\\n\n      This queue will no longer appear in the app, and any students currently in the queue will be removed.`,\n\n      onOk() {\n        disableQueue();\n      }\n\n    });\n  };\n\n  return /*#__PURE__*/_jsxs(InfoColumnContainer, {\n    children: [/*#__PURE__*/_jsxs(QueueInfo, {\n      children: [/*#__PURE__*/_jsxs(QueueRoomGroup, {\n        children: [/*#__PURE__*/_jsxs(QueueTitle, {\n          \"data-cy\": \"room-title\",\n          children: [queue === null || queue === void 0 ? void 0 : queue.room, \" \", (queue === null || queue === void 0 ? void 0 : queue.isDisabled) && /*#__PURE__*/_jsx(\"b\", {\n            children: \"(disabled)\"\n          })]\n        }), !queue.allowQuestions && /*#__PURE__*/_jsx(Tooltip, {\n          title: \"This queue is no longer accepting questions\",\n          children: /*#__PURE__*/_jsx(StopOutlined, {\n            \"data-cy\": \"stopQuestions\",\n            style: {\n              color: \"red\",\n              fontSize: \"24px\",\n              marginLeft: \"8px\"\n            }\n          })\n        })]\n      }), (queue === null || queue === void 0 ? void 0 : queue.isProfessorQueue) && /*#__PURE__*/_jsx(QueuePropertyRow, {\n        children: /*#__PURE__*/_jsx(Tag, {\n          color: \"blue\",\n          children: \"Professor Queue\"\n        })\n      })]\n    }), (queue === null || queue === void 0 ? void 0 : queue.notes) && /*#__PURE__*/_jsxs(QueuePropertyRow, {\n      children: [/*#__PURE__*/_jsx(NotificationOutlined, {}), /*#__PURE__*/_jsx(QueueText, {\n        children: /*#__PURE__*/_jsx(Linkify, {\n          componentDecorator: (decoratedHref, decoratedText, key) => /*#__PURE__*/_jsx(\"a\", {\n            target: \"_blank\",\n            rel: \"noopener noreferrer\",\n            href: decoratedHref,\n            children: decoratedText\n          }, key),\n          children: /*#__PURE__*/_jsx(QueuePropertyText, {\n            children: queue.notes\n          })\n        })\n      })]\n    }), /*#__PURE__*/_jsx(QueueUpToDateInfo, {\n      queueId: queueId\n    }), buttons, /*#__PURE__*/_jsx(StaffH2, {\n      children: \"Staff\"\n    }), /*#__PURE__*/_jsx(TAStatuses, {\n      queueId: queueId\n    }), isStaff && /*#__PURE__*/_jsxs(QueueManagementBox, {\n      children: [/*#__PURE__*/_jsx(Popconfirm, {\n        title: \"Are you sure you want to clear all students from the queue?\",\n        okText: \"Yes\",\n        cancelText: \"No\",\n        placement: \"top\",\n        arrowPointAtCenter: true,\n        onConfirm: clearQueue,\n        children: /*#__PURE__*/_jsx(ClearQueueButton, {\n          children: \"Clear Queue\"\n        })\n      }), /*#__PURE__*/_jsx(DisableQueueButton, {\n        onClick: confirmDisable,\n        \"data-cy\": \"queue-disable-button\",\n        disabled: queue === null || queue === void 0 ? void 0 : queue.isDisabled,\n        children: queue !== null && queue !== void 0 && queue.isDisabled ? `Queue deleted` : `Delete Queue`\n      })]\n    })]\n  });\n}\n\nfunction QueueUpToDateInfo({\n  queueId\n}) {\n  const {\n    0: lastUpdated,\n    1: setLastUpdated\n  } = useState(null);\n  const {\n    isLive\n  } = useQueue(queueId, setLastUpdated);\n  return /*#__PURE__*/_jsxs(QueuePropertyRow, {\n    className: \"hide-in-percy\",\n    children: [isLive || lastUpdated ? /*#__PURE__*/_jsx(CloudSyncOutlined, {}) : /*#__PURE__*/_jsx(FrownOutlined, {}), /*#__PURE__*/_jsx(QueuePropertyText, {\n      className: \"hide-in-percy\",\n      children: isLive ? \"Queue up to date\" : lastUpdated ? /*#__PURE__*/_jsx(RenderEvery, {\n        render: () => {\n          const secondsAgo = (Date.now() - lastUpdated.getTime()) / 1000;\n          return `Queue updated ${secondsAgo < 60 ? Math.ceil(secondsAgo) + \"s\" : moment(lastUpdated).fromNow(true)} ago`;\n        },\n        interval: 1000\n      }) : \"Queue may be out of date\"\n    })]\n  });\n}","map":null,"metadata":{},"sourceType":"module"}