{"ast":null,"code":"import { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport _regeneratorRuntime from \"/var/www/source/node_modules/next/node_modules/@babel/runtime/regenerator\";\nimport _objectWithoutProperties from \"/var/www/source/node_modules/next/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport _asyncToGenerator from \"/var/www/source/node_modules/next/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport { API } from \"@koh/api-client\";\nimport { Button, Modal } from \"antd\";\nimport moment from \"moment\";\nimport { useRouter } from \"next/router\";\nimport { useState } from \"react\";\nimport styled from \"styled-components\";\nimport { useCourse } from \"../../hooks/useCourse\";\nexport var CheckinButton = styled(Button).withConfig({\n  displayName: \"TACheckinButton__CheckinButton\",\n  componentId: \"sc-oiahss-0\"\n})([\"background:#2a9187;border-radius:6px;color:white;font-weight:500;font-size:14px;\"]);\nexport var CheckOutButton = styled(Button).withConfig({\n  displayName: \"TACheckinButton__CheckOutButton\",\n  componentId: \"sc-oiahss-1\"\n})([\"color:#da3236;font-weight:500;font-size:14px;border-radius:6px;\"]);\nvar EMPTY_CHECKOUT_INFO = {\n  canClearQueue: false,\n  nextOfficeHourTime: null\n};\nexport default function TACheckinButton(_ref) {\n  var courseId = _ref.courseId,\n      room = _ref.room,\n      state = _ref.state,\n      _ref$disabled = _ref.disabled,\n      disabled = _ref$disabled === void 0 ? false : _ref$disabled,\n      _ref$block = _ref.block,\n      block = _ref$block === void 0 ? false : _ref$block;\n  var router = useRouter();\n\n  var _useCourse = useCourse(courseId),\n      course = _useCourse.course,\n      mutateCourse = _useCourse.mutateCourse;\n\n  var _useState = useState(-1),\n      queueIdToClean = _useState[0],\n      setQueueIdToClean = _useState[1];\n\n  function checkInTA() {\n    return _checkInTA.apply(this, arguments);\n  }\n\n  function _checkInTA() {\n    _checkInTA = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3() {\n      var redirectID;\n      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              _context3.next = 2;\n              return API.taStatus.checkIn(courseId, room);\n\n            case 2:\n              redirectID = _context3.sent;\n              router.push(\"/course/[cid]/queue/[qid]\", \"/course/\".concat(courseId, \"/queue/\").concat(redirectID.id));\n\n            case 4:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3);\n    }));\n    return _checkInTA.apply(this, arguments);\n  }\n\n  var _useState2 = useState(EMPTY_CHECKOUT_INFO),\n      checkoutModalInfo = _useState2[0],\n      setCheckoutModalInfo = _useState2[1];\n\n  var closeModal = function closeModal() {\n    return setCheckoutModalInfo(EMPTY_CHECKOUT_INFO);\n  };\n\n  return /*#__PURE__*/_jsxs(_Fragment, {\n    children: [state === \"CheckedIn\" && /*#__PURE__*/_jsx(CheckOutButton, {\n      type: \"default\",\n      size: \"large\",\n      disabled: disabled,\n      block: block,\n      \"data-cy\": \"check-out-button\",\n      onClick: /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n        var _yield$API$taStatus$c, queueId, modalInfo;\n\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.next = 2;\n                return API.taStatus.checkOut(courseId, room);\n\n              case 2:\n                _yield$API$taStatus$c = _context.sent;\n                queueId = _yield$API$taStatus$c.queueId;\n                modalInfo = _objectWithoutProperties(_yield$API$taStatus$c, [\"queueId\"]);\n                setQueueIdToClean(queueId);\n                setCheckoutModalInfo(modalInfo);\n                mutateCourse();\n\n              case 8:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      })),\n      children: \"Check Out\"\n    }), state === \"CheckedOut\" && /*#__PURE__*/_jsx(CheckinButton, {\n      type: \"default\",\n      size: \"large\",\n      block: block,\n      onClick: function onClick() {\n        return checkInTA();\n      },\n      disabled: disabled || !course,\n      \"data-cy\": \"check-in-button\",\n      children: \"Check In\"\n    }), /*#__PURE__*/_jsxs(Modal, {\n      visible: checkoutModalInfo.canClearQueue,\n      title: \"Let's clean up...\",\n      onCancel: closeModal,\n      footer: [/*#__PURE__*/_jsx(Button, {\n        onClick: closeModal,\n        children: \"Leave Students In Queue\"\n      }, \"keep\"), /*#__PURE__*/_jsx(Button, {\n        type: \"primary\",\n        onClick: /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n          return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n            while (1) {\n              switch (_context2.prev = _context2.next) {\n                case 0:\n                  _context2.next = 2;\n                  return API.queues.clean(queueIdToClean);\n\n                case 2:\n                  closeModal();\n\n                case 3:\n                case \"end\":\n                  return _context2.stop();\n              }\n            }\n          }, _callee2);\n        })),\n        \"data-cy\": \"clear-queue-btn\",\n        children: \"Clear Queue\"\n      }, \"clear\")],\n      children: [\"You are the last TA to leave.\", \" \", checkoutModalInfo.nextOfficeHourTime ? /*#__PURE__*/_jsxs(_Fragment, {\n        children: [\"There will not be any office hours for\", \" \", /*#__PURE__*/_jsx(\"strong\", {\n          children: moment(checkoutModalInfo.nextOfficeHourTime).fromNow(true)\n        })]\n      }) : /*#__PURE__*/_jsx(\"strong\", {\n        children: \"There are no later office hours scheduled\"\n      }), \". Do you want to clear the remaining students out of the queue?\"]\n    })]\n  });\n}","map":null,"metadata":{},"sourceType":"module"}