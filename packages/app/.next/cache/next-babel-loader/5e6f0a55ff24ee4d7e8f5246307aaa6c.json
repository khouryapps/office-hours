{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nvar __jsx = React.createElement;\nimport { API } from \"@koh/api-client\";\nimport { Role } from \"@koh/common\";\nimport { Input, Modal, Radio } from \"antd\";\nimport { useRouter } from \"next/router\";\nimport React, { useState } from \"react\";\nimport styled from \"styled-components\";\nimport { useCourse } from \"../../hooks/useCourse\";\nimport { useProfile } from \"../../hooks/useProfile\";\nimport { useRoleInCourse } from \"../../hooks/useRoleInCourse\";\nimport TACheckinButton, { CheckinButton } from \"./TACheckinButton\";\nvar ProfessorModalRadio = styled(Radio).withConfig({\n  displayName: \"ProfessorCheckinButton__ProfessorModalRadio\",\n  componentId: \"dqhp9z-0\"\n})([\"display:block;height:30px;lineheight:30px;\"]);\nexport default function TodayPageCheckinButton() {\n  var profile = useProfile();\n\n  var _useState = useState(false),\n      modalVisible = _useState[0],\n      setModalVisible = _useState[1];\n\n  var _useState2 = useState(0),\n      queueToCheckInto = _useState2[0],\n      setQueueToCheckInto = _useState2[1];\n\n  var router = useRouter();\n  var cid = router.query.cid;\n\n  var _useCourse = useCourse(Number(cid)),\n      course = _useCourse.course;\n\n  var role = useRoleInCourse(Number(cid));\n  var queueCheckedIn = course === null || course === void 0 ? void 0 : course.queues.find(function (queue) {\n    return queue.staffList.find(function (staff) {\n      return staff.id === (profile === null || profile === void 0 ? void 0 : profile.id);\n    });\n  });\n\n  var _useState3 = useState(\"Professor \".concat(profile === null || profile === void 0 ? void 0 : profile.lastName, \"'s Office Hours\")),\n      queueToBeCreated = _useState3[0],\n      setQueueToBeCreated = _useState3[1];\n\n  return __jsx(React.Fragment, null, modalVisible && __jsx(Modal, {\n    title: \"Check-In To Office Hours\",\n    visible: modalVisible,\n    onCancel: function onCancel() {\n      return setModalVisible(false);\n    },\n    okText: \"Check In\",\n    onOk: /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var redirectID;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              if (!(queueToCheckInto > -1)) {\n                _context.next = 6;\n                break;\n              }\n\n              _context.next = 3;\n              return API.taStatus.checkIn(Number(cid), course === null || course === void 0 ? void 0 : course.queues[queueToCheckInto].room);\n\n            case 3:\n              redirectID = _context.sent;\n              _context.next = 9;\n              break;\n\n            case 6:\n              _context.next = 8;\n              return API.taStatus.checkIn(Number(cid), queueToBeCreated);\n\n            case 8:\n              redirectID = _context.sent;\n\n            case 9:\n              router.push(\"/course/[cid]/queue/[qid]\", \"/course/\".concat(Number(cid), \"/queue/\").concat(redirectID.id));\n\n            case 10:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }))\n  }, __jsx(\"h3\", null, \"Which queue would you like to check into?\"), __jsx(Radio.Group, {\n    value: queueToCheckInto,\n    onChange: function onChange(e) {\n      return setQueueToCheckInto(e.target.value);\n    }\n  }, course === null || course === void 0 ? void 0 : course.queues.map(function (q, i) {\n    return __jsx(ProfessorModalRadio, {\n      key: q.id,\n      value: i\n    }, q.room);\n  }), __jsx(ProfessorModalRadio, {\n    value: -1\n  }, \"Other...\", queueToCheckInto === -1 ? __jsx(Input, {\n    defaultValue: \"Professor \".concat(profile.lastName, \"'s Office Hours\"),\n    onChange: function onChange(e) {\n      return setQueueToBeCreated(e.target.value);\n    },\n    style: {\n      width: 400,\n      marginLeft: 10\n    }\n  }) : null))), role === Role.TA && __jsx(TACheckinButton, {\n    courseId: Number(cid),\n    room: \"Online\",\n    state: queueCheckedIn ? \"CheckedIn\" : \"CheckedOut\"\n  }), !queueCheckedIn && role === Role.PROFESSOR && __jsx(CheckinButton, {\n    type: \"default\",\n    size: \"large\",\n    onClick: function onClick() {\n      return setModalVisible(true);\n    }\n  }, \"Check In\"), queueCheckedIn && role === Role.PROFESSOR && __jsx(TACheckinButton, {\n    courseId: Number(cid),\n    room: queueCheckedIn.room,\n    state: \"CheckedIn\"\n  }));\n}","map":{"version":3,"sources":["/var/www/source/packages/app/components/Today/ProfessorCheckinButton.tsx"],"names":["API","Role","Input","Modal","Radio","useRouter","React","useState","styled","useCourse","useProfile","useRoleInCourse","TACheckinButton","CheckinButton","ProfessorModalRadio","TodayPageCheckinButton","profile","modalVisible","setModalVisible","queueToCheckInto","setQueueToCheckInto","router","cid","query","Number","course","role","queueCheckedIn","queues","find","queue","staffList","staff","id","lastName","queueToBeCreated","setQueueToBeCreated","taStatus","checkIn","room","redirectID","push","e","target","value","map","q","i","width","marginLeft","TA","PROFESSOR"],"mappings":"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","sourcesContent":["import { API } from \"@koh/api-client\";\nimport { QueuePartial, Role } from \"@koh/common\";\nimport { Input, Modal, Radio } from \"antd\";\nimport { useRouter } from \"next/router\";\nimport React, { ReactElement, useState } from \"react\";\nimport styled from \"styled-components\";\nimport { useCourse } from \"../../hooks/useCourse\";\nimport { useProfile } from \"../../hooks/useProfile\";\nimport { useRoleInCourse } from \"../../hooks/useRoleInCourse\";\nimport TACheckinButton, { CheckinButton } from \"./TACheckinButton\";\n\nconst ProfessorModalRadio = styled(Radio)`\n  display: block;\n  height: 30px;\n  lineheight: 30px;\n`;\n\nexport default function TodayPageCheckinButton(): ReactElement {\n  const profile = useProfile();\n  const [modalVisible, setModalVisible] = useState(false);\n  const [queueToCheckInto, setQueueToCheckInto] = useState(0);\n  const router = useRouter();\n  const { cid } = router.query;\n  const { course } = useCourse(Number(cid));\n  const role = useRoleInCourse(Number(cid));\n  const queueCheckedIn = course?.queues.find((queue) =>\n    queue.staffList.find((staff) => staff.id === profile?.id)\n  );\n  const [queueToBeCreated, setQueueToBeCreated] = useState(\n    `Professor ${profile?.lastName}'s Office Hours`\n  );\n\n  return (\n    <>\n      {modalVisible && (\n        <Modal\n          title=\"Check-In To Office Hours\"\n          visible={modalVisible}\n          onCancel={() => setModalVisible(false)}\n          okText=\"Check In\"\n          onOk={async () => {\n            let redirectID: QueuePartial;\n            if (queueToCheckInto > -1) {\n              redirectID = await API.taStatus.checkIn(\n                Number(cid),\n                course?.queues[queueToCheckInto].room\n              );\n            } else {\n              redirectID = await API.taStatus.checkIn(\n                Number(cid),\n                queueToBeCreated\n              );\n            }\n            router.push(\n              \"/course/[cid]/queue/[qid]\",\n              `/course/${Number(cid)}/queue/${redirectID.id}`\n            );\n          }}\n        >\n          <h3>Which queue would you like to check into?</h3>\n          <Radio.Group\n            value={queueToCheckInto}\n            onChange={(e) => setQueueToCheckInto(e.target.value)}\n          >\n            {course?.queues.map((q, i) => (\n              <ProfessorModalRadio key={q.id} value={i}>\n                {q.room}\n              </ProfessorModalRadio>\n            ))}\n            <ProfessorModalRadio value={-1}>\n              Other...\n              {queueToCheckInto === -1 ? (\n                <Input\n                  defaultValue={`Professor ${profile.lastName}'s Office Hours`}\n                  onChange={(e) => setQueueToBeCreated(e.target.value)}\n                  style={{ width: 400, marginLeft: 10 }}\n                />\n              ) : null}\n            </ProfessorModalRadio>\n          </Radio.Group>\n        </Modal>\n      )}\n      {role === Role.TA && (\n        <TACheckinButton\n          courseId={Number(cid)}\n          room={\"Online\"}\n          state={queueCheckedIn ? \"CheckedIn\" : \"CheckedOut\"}\n        />\n      )}\n      {!queueCheckedIn && role === Role.PROFESSOR && (\n        <CheckinButton\n          type=\"default\"\n          size=\"large\"\n          onClick={() => setModalVisible(true)}\n        >\n          Check In\n        </CheckinButton>\n      )}\n      {queueCheckedIn && role === Role.PROFESSOR && (\n        <TACheckinButton\n          courseId={Number(cid)}\n          room={queueCheckedIn.room}\n          state=\"CheckedIn\"\n        />\n      )}\n    </>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}