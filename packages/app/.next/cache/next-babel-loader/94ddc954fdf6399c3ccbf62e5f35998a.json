{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport { DeleteOutlined } from \"@ant-design/icons\";\nimport { API } from \"@koh/api-client\";\nimport { Button, message, Switch, Table } from \"antd\";\nimport React from \"react\";\nimport styled from \"styled-components\";\nimport useSWR from \"swr\";\nimport { useCourse } from \"../../hooks/useCourse\";\nimport AddOverrideInput from \"./AddOverrideInput\";\nvar Column = Table.Column;\nvar OverrideContents = styled.div.withConfig({\n  displayName: \"CourseOverrideSettings__OverrideContents\",\n  componentId: \"sc-18esdfc-0\"\n})([\"width:90%;margin-left:auto;margin-right:auto;padding-top:50px;\"]);\nexport default function CourseOverrideSettings(_ref) {\n  var courseId = _ref.courseId;\n\n  var _useSWR = useSWR(\"/api/v1/courses/course_override\", /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            return _context.abrupt(\"return\", API.course.getCourseOverrides(courseId));\n\n          case 1:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee);\n  }))),\n      data = _useSWR.data,\n      mutate = _useSWR.mutate;\n\n  var _useCourse = useCourse(courseId),\n      course = _useCourse.course,\n      mutateCourse = _useCourse.mutateCourse;\n\n  var formattedRoles = {\n    student: \"Student\",\n    ta: \"TA\",\n    professor: \"Professor\"\n  };\n  return __jsx(OverrideContents, null, __jsx(AddOverrideInput, {\n    courseId: courseId,\n    onAddOverride: function onAddOverride() {\n      return mutate();\n    }\n  }), __jsx(Table, {\n    dataSource: data === null || data === void 0 ? void 0 : data.data.map(function (row, i) {\n      return _objectSpread(_objectSpread({}, row), {}, {\n        key: i,\n        role: formattedRoles[row.role]\n      });\n    })\n  }, __jsx(Column, {\n    title: \"Name\",\n    dataIndex: \"name\",\n    key: \"name\"\n  }), __jsx(Column, {\n    title: \"Email\",\n    dataIndex: \"email\",\n    key: \"email\"\n  }), __jsx(Column, {\n    title: \"Role\",\n    dataIndex: \"role\",\n    key: \"role\"\n  }), __jsx(Column, {\n    title: \"Delete\",\n    key: \"delete\",\n    render: function render(text, record) {\n      return __jsx(Button, {\n        onClick: /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n          return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n            while (1) {\n              switch (_context2.prev = _context2.next) {\n                case 0:\n                  _context2.next = 2;\n                  return API.course.deleteOverride(courseId, {\n                    email: record.email,\n                    role: record.role\n                  });\n\n                case 2:\n                  message.success(\"Successfully deleted the override for \" + record.name);\n                  mutate();\n\n                case 4:\n                case \"end\":\n                  return _context2.stop();\n              }\n            }\n          }, _callee2);\n        })),\n        type: \"link\",\n        style: {\n          textAlign: \"center\"\n        },\n        icon: __jsx(DeleteOutlined, {\n          style: {\n            color: \"red\"\n          }\n        })\n      });\n    }\n  })), __jsx(\"div\", null, \"Is Khoury Admin/Banner down? Toggle this to temporarily allow students to join your class.\", \" \", __jsx(Switch, {\n    onChange: /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3() {\n      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              _context3.next = 2;\n              return API.course.toggleSelfEnroll(courseId);\n\n            case 2:\n              mutateCourse();\n\n            case 3:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3);\n    })),\n    defaultChecked: course === null || course === void 0 ? void 0 : course.selfEnroll\n  })), __jsx(\"b\", null, \"You must manually toggle this feature off later, or any student will be allowed to join your class.\"));\n}","map":{"version":3,"sources":["/var/www/source/packages/app/components/Settings/CourseOverrideSettings.tsx"],"names":["DeleteOutlined","API","Button","message","Switch","Table","React","styled","useSWR","useCourse","AddOverrideInput","Column","OverrideContents","div","CourseOverrideSettings","courseId","course","getCourseOverrides","data","mutate","mutateCourse","formattedRoles","student","ta","professor","map","row","i","key","role","text","record","deleteOverride","email","success","name","textAlign","color","toggleSelfEnroll","selfEnroll"],"mappings":";;;;;;;;;AAAA,SAASA,cAAT,QAA+B,mBAA/B;AACA,SAASC,GAAT,QAAoB,iBAApB;AAEA,SAASC,MAAT,EAAiBC,OAAjB,EAA0BC,MAA1B,EAAkCC,KAAlC,QAA+C,MAA/C;AACA,OAAOC,KAAP,MAAoC,OAApC;AACA,OAAOC,MAAP,MAAmB,mBAAnB;AACA,OAAOC,MAAP,MAAmB,KAAnB;AACA,SAASC,SAAT,QAA0B,uBAA1B;AACA,OAAOC,gBAAP,MAA6B,oBAA7B;IAEQC,M,GAAWN,K,CAAXM,M;AAIR,IAAMC,gBAAgB,GAAGL,MAAM,CAACM,GAAV;AAAA;AAAA;AAAA,sEAAtB;AAOA,eAAe,SAASC,sBAAT,OAE+B;AAAA,MAD5CC,QAC4C,QAD5CA,QAC4C;;AAAA,gBACnBP,MAAM,0GAAoC;AAAA;AAAA;AAAA;AAAA;AAAA,6CACjEP,GAAG,CAACe,MAAJ,CAAWC,kBAAX,CAA8BF,QAA9B,CADiE;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAApC,GADa;AAAA,MACpCG,IADoC,WACpCA,IADoC;AAAA,MAC9BC,MAD8B,WAC9BA,MAD8B;;AAAA,mBAKXV,SAAS,CAACM,QAAD,CALE;AAAA,MAKpCC,MALoC,cAKpCA,MALoC;AAAA,MAK5BI,YAL4B,cAK5BA,YAL4B;;AAO5C,MAAMC,cAAc,GAAG;AACrBC,IAAAA,OAAO,EAAE,SADY;AAErBC,IAAAA,EAAE,EAAE,IAFiB;AAGrBC,IAAAA,SAAS,EAAE;AAHU,GAAvB;AAMA,SACE,MAAC,gBAAD,QACE,MAAC,gBAAD;AAAkB,IAAA,QAAQ,EAAET,QAA5B;AAAsC,IAAA,aAAa,EAAE;AAAA,aAAMI,MAAM,EAAZ;AAAA;AAArD,IADF,EAEE,MAAC,KAAD;AACE,IAAA,UAAU,EAAED,IAAF,aAAEA,IAAF,uBAAEA,IAAI,CAAEA,IAAN,CAAWO,GAAX,CAAe,UAACC,GAAD,EAAMC,CAAN;AAAA,6CACtBD,GADsB;AAEzBE,QAAAA,GAAG,EAAED,CAFoB;AAGzBE,QAAAA,IAAI,EAAER,cAAc,CAACK,GAAG,CAACG,IAAL;AAHK;AAAA,KAAf;AADd,KAOE,MAAC,MAAD;AAAQ,IAAA,KAAK,EAAC,MAAd;AAAqB,IAAA,SAAS,EAAC,MAA/B;AAAsC,IAAA,GAAG,EAAC;AAA1C,IAPF,EAQE,MAAC,MAAD;AAAQ,IAAA,KAAK,EAAC,OAAd;AAAsB,IAAA,SAAS,EAAC,OAAhC;AAAwC,IAAA,GAAG,EAAC;AAA5C,IARF,EASE,MAAC,MAAD;AAAQ,IAAA,KAAK,EAAC,MAAd;AAAqB,IAAA,SAAS,EAAC,MAA/B;AAAsC,IAAA,GAAG,EAAC;AAA1C,IATF,EAUE,MAAC,MAAD;AACE,IAAA,KAAK,EAAC,QADR;AAEE,IAAA,GAAG,EAAC,QAFN;AAGE,IAAA,MAAM,EAAE,gBAACC,IAAD,EAAOC,MAAP;AAAA,aACN,MAAC,MAAD;AACE,QAAA,OAAO,wEAAE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,yBACD9B,GAAG,CAACe,MAAJ,CAAWgB,cAAX,CAA0BjB,QAA1B,EAAoC;AACxCkB,oBAAAA,KAAK,EAAEF,MAAM,CAACE,KAD0B;AAExCJ,oBAAAA,IAAI,EAAEE,MAAM,CAACF;AAF2B,mBAApC,CADC;;AAAA;AAKP1B,kBAAAA,OAAO,CAAC+B,OAAR,CACE,2CAA2CH,MAAM,CAACI,IADpD;AAGAhB,kBAAAA,MAAM;;AARC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAAF,EADT;AAWE,QAAA,IAAI,EAAC,MAXP;AAYE,QAAA,KAAK,EAAE;AAAEiB,UAAAA,SAAS,EAAE;AAAb,SAZT;AAaE,QAAA,IAAI,EAAE,MAAC,cAAD;AAAgB,UAAA,KAAK,EAAE;AAAEC,YAAAA,KAAK,EAAE;AAAT;AAAvB;AAbR,QADM;AAAA;AAHV,IAVF,CAFF,EAkCE,iHAEsB,GAFtB,EAGE,MAAC,MAAD;AACE,IAAA,QAAQ,wEAAE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBACFpC,GAAG,CAACe,MAAJ,CAAWsB,gBAAX,CAA4BvB,QAA5B,CADE;;AAAA;AAERK,cAAAA,YAAY;;AAFJ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAF,EADV;AAKE,IAAA,cAAc,EAAEJ,MAAF,aAAEA,MAAF,uBAAEA,MAAM,CAAEuB;AAL1B,IAHF,CAlCF,EA6CE,uHA7CF,CADF;AAoDD","sourcesContent":["import { DeleteOutlined } from \"@ant-design/icons\";\nimport { API } from \"@koh/api-client\";\nimport { GetCourseOverridesRow, Role } from \"@koh/common\";\nimport { Button, message, Switch, Table } from \"antd\";\nimport React, { ReactElement } from \"react\";\nimport styled from \"styled-components\";\nimport useSWR from \"swr\";\nimport { useCourse } from \"../../hooks/useCourse\";\nimport AddOverrideInput from \"./AddOverrideInput\";\n\nconst { Column } = Table;\n\ntype CourseOverrideSettingsProps = { courseId: number };\n\nconst OverrideContents = styled.div`\n  width: 90%;\n  margin-left: auto;\n  margin-right: auto;\n  padding-top: 50px;\n`;\n\nexport default function CourseOverrideSettings({\n  courseId,\n}: CourseOverrideSettingsProps): ReactElement {\n  const { data, mutate } = useSWR(`/api/v1/courses/course_override`, async () =>\n    API.course.getCourseOverrides(courseId)\n  );\n\n  const { course, mutateCourse } = useCourse(courseId);\n\n  const formattedRoles = {\n    student: \"Student\",\n    ta: \"TA\",\n    professor: \"Professor\",\n  };\n\n  return (\n    <OverrideContents>\n      <AddOverrideInput courseId={courseId} onAddOverride={() => mutate()} />\n      <Table\n        dataSource={data?.data.map((row, i) => ({\n          ...row,\n          key: i,\n          role: formattedRoles[row.role],\n        }))}\n      >\n        <Column title=\"Name\" dataIndex=\"name\" key=\"name\" />\n        <Column title=\"Email\" dataIndex=\"email\" key=\"email\" />\n        <Column title=\"Role\" dataIndex=\"role\" key=\"role\" />\n        <Column\n          title=\"Delete\"\n          key=\"delete\"\n          render={(text, record: GetCourseOverridesRow) => (\n            <Button\n              onClick={async () => {\n                await API.course.deleteOverride(courseId, {\n                  email: record.email,\n                  role: record.role as Role,\n                });\n                message.success(\n                  \"Successfully deleted the override for \" + record.name\n                );\n                mutate();\n              }}\n              type=\"link\"\n              style={{ textAlign: \"center\" }}\n              icon={<DeleteOutlined style={{ color: \"red\" }} />}\n            />\n          )}\n        />\n      </Table>\n      <div>\n        Is Khoury Admin/Banner down? Toggle this to temporarily allow students\n        to join your class.{\" \"}\n        <Switch\n          onChange={async () => {\n            await API.course.toggleSelfEnroll(courseId);\n            mutateCourse();\n          }}\n          defaultChecked={course?.selfEnroll}\n        />\n      </div>\n      <b>\n        You must manually toggle this feature off later, or any student will be\n        allowed to join your class.\n      </b>\n    </OverrideContents>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}